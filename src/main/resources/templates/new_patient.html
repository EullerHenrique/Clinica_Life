<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-CuOF+2SnTUfTwSZjCXf01h7uYhfOBuxIhGKPbfEJ3+FqH/s6cIFN9bGr1HmAg4fQ" crossorigin="anonymous">
    <style>

        nav, footer, .btn{
            background-color: #6495ED;
        }

        p{
            text-align: justify;
        }

        h1, h2, footer p{
            text-align: center;
        }

        footer p{
            padding: 10px 0;
            margin: 0;
        }

        .footer{
            width: 100%;
            position: fixed;
            bottom: 0px;
        }


        #especialidade, #crm{
            display: none;
        }


    </style>

</head>
<body>

<header>

    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">

            <a class="navbar-brand" href="../cads/cad_funcionario.php">
                <img src="../../images/foto_logo.png" alt="Clinica life" width="60" height="45" class="d-inline-block align-top">
            </a>


            <button class="navbar-toggler shadow-none" type="button" data-toggle="collapse" data-target="#navbar">
                <span class="navbar-toggler-icon"></span>
            </button>


            <div class="collapse navbar-collapse" id="navbar">

                <div class="navbar-nav w-100">
                    <a href="../cads/cad_funcionario.php"
                    class="nav-link"

                    >Novo Funcionário
                    </a>
                    <a href="../cads/cad_paciente.php"

                    class="nav-link"

                    >Novo Paciente
                    </a>
                    <a href="../lists/list_funcionarios.php"

                    class="nav-link"

                    >Funcionários
                    </a>


                    <a href="../lists/list_enderecos_auxiliares.php"
                       class="nav-link"

                    >Endereços Auxiliares
                    </a>


                    <a href="../lists/list_pacientes.php" class="nav-link">Pacientes</a>

                    <a href="../lists/list_agendamentos.php"
                    class="nav-link"

                    >Agendamentos
                    </a>


                    <!-- Médico -->


                    <a href="../lists/list_meus_agendamentos.php"
                    class="nav-link"

                    >Meus Agendamentos
                    </a>

                    <!--- -->

                </div>

                <div class="navbar-nav">
                    <a href="../../public/pages/home.php" class="nav-link">Sair</a>
                </div>

            </div>

        </div>

    </nav>

</header>
<main>

    <div class="container">

        <article class="mt-5 mb-5">

            <h1>Cadastrar Paciente</h1>

            <form method="post" class="mt-4">

                <div class="row">

                    <div class="mb-3 form-floating col-md-6">
                        <input type="text" class="form-control" id="nome" name="nome" placeholder="Nome" required>
                        <label for="nome" class="form-label">Nome</label>
                    </div>

                    <div class="mb-3 form-floating col-md-6">
                        <input type="tel" class="form-control" id="telefone" name="telefone" placeholder="telefone" required>
                        <label for="telefone" class="form-label">Telefone </label>
                    </div>

                    <div class="mb-3 form-floating col-md-6">
                        <input type="email" class="form-control" id="email" name="email" placeholder="E-mail" required>
                        <label for="email" class="form-label">E-mail</label>
                    </div>

                    <div class="mb-3 form-floating col-md-2">
                        <input type="text" class="form-control" id="cep" name="cep" placeholder="cep" required>
                        <label for="cep" class="form-label">CEP</label>
                    </div>

                    <div class="mb-3 form-floating col-md-4">
                        <input type="text" class="form-control" id="logradouro" name="logradouro" placeholder="Logradouro" required>
                        <label for="logradouro" class="form-label">Logradouro</label>
                    </div>

                    <div class="mb-3 col-md form-floating">
                        <input type="number" class="form-control" id="peso" name="peso" placeholder="Peso" required>
                        <label for="peso" class="form-label">Peso (kg) </label>
                    </div>


                    <div class="mb-3 col-md form-floating">
                        <input type="number" class="form-control" id="altura" name="altura" placeholder="Altura" required>
                        <label for="altura" class="form-label">Altura (cm) </label>
                    </div>

                    <div class="mb-3 col-md form-floating">
                        <select id="tipo_sanguineo" class="form-select" name="tipo_sanguineo" required>
                            <option value="">&nbsp;</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                        <label for="tipo_sanguineo" class="form-label">Tipo Sanguíneo</label>
                    </div>


                    <div class="mb-3 form-floating col-md-2">
                        <input type="text" class="form-control" id="bairro" name="bairro" placeholder="Bairro" required>
                        <label for="bairro" class="form-label">Bairro</label>
                    </div>


                    <div class="mb-3 col-md-2 form-floating">
                        <input type="text" class="form-control" id="cidade" name="cidade" placeholder="Cidade" required>
                        <label for="cidade" class="form-label">Cidade</label>
                    </div>

                    <div class="mb-3 col-md-2 form-floating">
                        <select id="estado" class="form-select" name="estado" required>
                            <option value="">&nbsp;</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                        <label for="estado" class="form-label">Estado</label>
                    </div>


                    <div class="text-center">
                        <button type="submit" class="btn text-white">Cadastrar</button>
                    </div>


                    <div class="mt-3 mb-2">

                        <p class="text-center text-success">Paciente cadastrado com sucesso</p>

                        <p class="text-center text-danger">Falha no cadastro, tente novamente</p>

                        <p class="text-center text-warning">Falha no cadastro: E-mail duplicado</p>

                    </div>

                </div>

            </form>

        </article>

    </div>

</main>

<footer class="footer d-none d-md-block">

    <p>Copyright &copy; 2020. Todos os direitos reservados.</p>

</footer>


<footer class="d-md-none">

    <p>Copyright &copy; 2020. Todos os direitos reservados.</p>

</footer>

<footer class="footer">

    <p>Copyright &copy; 2020. Todos os direitos reservados.</p>

</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-popRpmFF9JQgExhfw5tZT4I9/CI5e2QcuUZPOVXb1m7qUmeR2b50u+YFEYe1wgzy" crossorigin="anonymous"></script>

</body>
</html>



<script>

    const inputCep = document.querySelector("#cep");
    inputCep.onkeyup = (e) => buscaEndereco(inputCep.value);


    function buscaEndereco(cep) {

        if(cep.toString().length === 9) {

            let form = document.forms[0];

            let url = 'http://localhost:8080/new_adress_aux/' + cep;

            //A api fetch busca uma resposta na url

            fetch(url)

                .then(response => {

                    // A requisição finalizou com sucesso.

                    if (response.ok) {

                        // Converte a string JSON para um objeto JS
                        // A execução prosseguirá para o próximo .then

                        return response.json();
                    } else {

                        // A execução será deslocada para o bloco 'catch'
                        return Promise.reject(response);
                    }

                })

                .then(endereco => {

                    form.logradouro.value = endereco.logradouro;
                    form.bairro.value = endereco.bairro;
                    form.cidade.value = endereco.cidade;
                    form.estado.value = endereco.estado;

                })

                .catch(error => {

                    // Ocorreu um erro na comunicação com o servidor ou
                    // no processamento da requisição no JAVA, que pode não
                    // ter retornado uma string JSON válida

                    //Redefine os valores do formulário

                    form.logradouro.value = null;
                    form.bairro.value = null;
                    form.cidade.value = null;
                    form.estado.value = null;

                    console.warn('Falha inesperada: ', error);

                });
        }
    }

</script>

        